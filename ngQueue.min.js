/*! ngQueue
version: 0.1.0
build date: 2014-01-18
author: Robin Fan
https://github.com/pc035860/ngQueue.git */
angular.module("ngQueue",[]).factory("$queueFactory",["$q","$window","$timeout","$rootScope",function(a,b,c,d){var e=function(a){this.init(a)},f=e.prototype;return f._limit=null,f._queue=null,f._deferFunc=null,f.init=function(a){this._limit=a.limit,this._queue=[],("boolean"==typeof a.deferred&&a.deferred||"number"==typeof a.deferred&&a.deferred>=0)&&(this._deferFunc=function(){var e=Number(a.deferred),f=b.setImmediate||function(a){c(a,0,!0)},g=null,h=function(){return b.performance&&b.performance.now?b.performance.now():+new Date};return function(a){var b=h();null===g||h()-g>=e?(g=b,f(function(){a(),d.$apply()})):a()}}())},f.enqueue=function(a,b,c){var d=[a,b,c];return this._queue.push([a,b,c]),this.dequeue(),d},f.remove=function(a){var b=this._queue.indexOf(a);return this._queue.splice(b,1)[0]},f.dequeue=function(){if(!(this._limit<=0||0===this._queue.length)){this._limit--;var b,c,d=this._queue.shift(),e=d[0],f=d[1],g=d[2],h=this;b=c=function(){h._limit++,h._deferFunc?h._deferFunc(function(){h.dequeue()}):h.dequeue()},a.when(e.apply(f||null,g||null)).then(b,c)}},f.clear=function(){this._queue.length=0},function(a,b){var c;return angular.isObject(a)?c=a:(a=a||1,angular.isUndefined(b)&&(b=!1),c={limit:a,deferred:b}),new e(c)}}]);